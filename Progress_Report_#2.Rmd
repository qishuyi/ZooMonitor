---
title: 'Progress Report #2'
author: "Shuyi Qi, Hinako Minagi, Riu Sakaguchi"
date: "2/27/2020"
output: 
  html_document:
    theme: yeti
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

```{r Loading Libraries}
library(readr)
library(dplyr)
library(tidyr)
library(stringr)
library(magrittr)
library(ggplot2)
library(lubridate)
library(gridExtra)
library(grid)
library(formattable) #To make a nice table
library(zoo)
library(tibble)
library(ggbeeswarm)
```


```{r Source}
source("cleaning.R")
source("columns_addition.R")
```

#### **Notes**

Hello Anna! We have created some visualizations that you requested during the first meeting and in the follow-up email.  
The figures include:  

+ **Figure 1**: Barplots displaying the frequency and percentage of dogs' inactive behaviors based on the six-month intervals. This plot helps you discover the shifts in dogs' different types of inactiveness throughout the observational period.  
+ **Figure 2**: Barplots displaying the percentage of observations per day of week, and time of day. This plot is useful in identifying certian days of the week or times of the day where few/many observations have been recorded.

We hope that the visualizations we created in this progress report is helpful for you! 


<br>

#### **Figure 1.**

```{r Inactivity Plot in 6 Month Intervals, fig.height = 8, fig.width = 10}
## Other's Percentage (in six-month intervals)
# Create barplots for the frequencies
inactive_obs2 <- dogs_data %>% filter(Activeness == "Inactive")
six_month_frequency <- ggplot(data=inactive_obs2) + 
  geom_bar(aes(x=Activity), fill = "coral", alpha = 0.7) + 
  labs(title = "Frequency of recorded inactive behaviors (in 6-month intervals)", x = "Dogs' behavior when inactive", y = "Frequency") +
  facet_grid((. ~Six_Month_Interval)) +
  theme(plot.title = element_text(face = "bold"), axis.text.x = element_text(angle = 30, hjust = 1))

inactive_obs <- dogs_data %>% 
  filter(Activeness == 'Inactive') %>% 
  group_by(Six_Month_Interval, Activity) %>%
  summarize(n = n()) %>%
  mutate(Percentage = n/sum(n)*100)

six_month_percentage <- ggplot(inactive_obs, aes(x=Six_Month_Interval, y=Percentage, fill=Activity)) +
  geom_col(position = "stack", width = 0.4) +
  labs(title = "Percentage of inactive behaviors (in 6-month intervals)", x = "Six Month Intervals", y = "Percentage of observations (%)") +
  scale_fill_manual(values = c("coral","cornflowerblue", "darkolivegreen3", "darkorchid1", "darkcyan")) +
  theme(plot.title = element_text(face = "bold"))

grid.arrange(six_month_frequency, six_month_percentage,  nrow = 2)
```

**1a.**

* The **upper** plot illustrates the **frequency** with which different types of inactive behaviors were recorded in six-month intervals. 
* The plot shows that the number of observations in which the observer selected 'Other' is relatively similar (fewer than 125) across all four six-month intervals.
* We also notice that there are fewer observations that recorded inactive behaviors during the first two intervals.
* The number of observations for inactivity between 2019-03-01 and 2020-01-11 is significantly higher.
* Resting is the most common inactive behavior, especially between 2019-03-01 and 2019-09-01.


**1b.**

* The **bottom** plot displays the **percentage** of observations where 'Other' was selected among all types of inactive behaviors in six-month intervals. 
* The color scale on the right demonstrates the correspondance between colors and different types of inactive behaviors.
* All percentages should add up to 100%
* Over 25% of the observations between 2018-09-01 and 2019-03-01 recorded dogs' inactive behavior as 'Other'. Around 12.5% of the inactive observations between 2018-03-01 and 2018-09-01 were 'Other'. However, the high percentage could be due to the low number of total observations in the first two intervals.
* Less than 10% of the inactive observations recorded in the last two intervals were classified as 'Other'.

\

\

\

<br>

#### **Figure 2.**

```{r Percentage of Observations based on Day of Week/Time of Day, fig.height = 6, fig.width = 10}
time_of_day_viz <- ggplot(data = dogs_data, aes(x = Hour)) + 
  geom_bar(aes(y = ..count../nrow(dogs_data)*100), fill = "steelblue", width = .75) + 
  scale_x_discrete(limits = 9:16) +
  scale_y_continuous(limits = c(0,25)) + 
  geom_hline(yintercept = (1/8)*100, color = "darkmagenta", alpha = .45, linetype = "longdash") +
  labs(title = "b. Percentage of Observations (Per Time of Day)", x = "Time of Day", y = "Percentage (%)") +
  annotate("text", x= 16.6, y = 13.5 , label = "12.5%", color = "darkmagenta", size = 3.25) +
  theme(plot.title = element_text(face = "bold"))

day_of_week_viz <- ggplot(data = dogs_data, aes(x = Day_of_Week)) +
  geom_bar(aes(y = ..count../nrow(dogs_data)*100), fill = "steelblue2", width = .75) +
  scale_x_discrete(limits=c("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun")) +
  scale_y_continuous(limits = c(0,60)) +
  labs(title = "a. Percentage of Observations (Per Day of Week)", x = "Day of Week", y = "Percentage (%)") +
  geom_hline(yintercept = (1/7)*100, color = "darkmagenta", alpha = .45, linetype = "longdash") +   annotate("text", x= 1.5, y = 16.5 , label = "14.28%", color = "darkmagenta", size = 3.25) +
  theme(plot.title = element_text(face = "bold"))

grid.arrange(day_of_week_viz, time_of_day_viz,  nrow = 1)

```

**2a.**

* The plot on the **left** illustrates the percentage of observations recorded on each day of the week. 
* If observations were recorded equally throughout the days of the week, then the height of the bars should match the purple dashed line.
  + That is, each day would consist of 14.28% of the total number of observations if there was equal representation for the days of the week.
* The plot suggests that over 50% of all observations in the data are recorded on Saturdays.
* Friday is the day of the week where the least number of observations were recorded. 


**2b.**

* The plot on the **right** displays the percentage of observations recorded on each hour of the day.
* If equal numbers of observations were recorded on each hour of the day, the height of the bars should match up with the purple dashed line. 
  + In otherwords, each hour of the day would consist of 12.5% of the total number of observations if there was equal representation for the times of the day.
* The plot suggests that 9AM, 10AM, and 2PM (14), are the times in which most observations are recorded.
* It appears as though not a lot of observations are recorded at 12PM and 4PM (16).

\


